<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CobraDash Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #020617; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .active-tab { color: #3b82f6; border-top: 2px solid #3b82f6; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-200 pb-24">

    <nav class="sticky top-0 z-50 glass px-6 py-4 flex justify-between items-center">
        <h1 class="text-xl font-extrabold tracking-tighter italic text-white">COBRA<span class="text-blue-500">DASH</span></h1>
        <div class="bg-blue-500/10 px-3 py-1 rounded-full border border-blue-500/20 text-[10px] font-bold text-blue-400 uppercase tracking-widest">Intelligence</div>
    </nav>

    <main class="max-w-md mx-auto px-4 mt-6">
        
        <section id="sales" class="tab-content active space-y-6">
            <div class="grid grid-cols-2 gap-4">
                <div class="glass p-5 rounded-[2rem]">
                    <p class="text-slate-500 text-[10px] font-bold uppercase">Faturamento</p>
                    <p id="sales-total" class="text-xl font-extrabold text-white">R$ 0,00</p>
                </div>
                <div class="glass p-5 rounded-[2rem]">
                    <p class="text-slate-500 text-[10px] font-bold uppercase">Conversão</p>
                    <p class="text-xl font-extrabold text-blue-400">8.2%</p>
                </div>
            </div>
            <div id="sales-list" class="space-y-3">
                <p class="text-center text-slate-500 text-sm">Carregando vendas...</p>
            </div>
        </section>

        <section id="leads" class="tab-content space-y-6">
            <div class="glass p-6 rounded-[2rem] text-center border-l-4 border-l-purple-500">
                <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest">Total de Leads</p>
                <p id="leads-count" class="text-5xl font-black text-white my-2">0</p>
                <p class="text-xs text-purple-400 font-bold">Aguardando atendimento</p>
            </div>
            <div class="glass p-5 rounded-[2rem] space-y-4">
                <h4 class="text-xs font-bold uppercase text-slate-400">Status do Comercial</h4>
                <div class="flex justify-between text-sm"><span>Em negociação</span><span class="font-bold">24</span></div>
                <div class="flex justify-between text-sm"><span>Perdidos</span><span class="font-bold text-red-400">12</span></div>
            </div>
        </section>

        <section id="traffic" class="tab-content space-y-6">
            <div class="glass p-6 rounded-[2rem] bg-gradient-to-br from-blue-900/20 to-transparent">
                <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest">Investimento Total</p>
                <p id="traffic-spend" class="text-4xl font-black text-white mt-2">R$ 0,00</p>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div class="glass p-4 rounded-3xl text-center">
                    <p class="text-[10px] text-slate-500 font-bold">CPC MÉDIO</p>
                    <p class="font-bold text-blue-400">R$ 0,85</p>
                </div>
                <div class="glass p-4 rounded-3xl text-center">
                    <p class="text-[10px] text-slate-500 font-bold">ROAS</p>
                    <p class="font-bold text-emerald-400">4.5x</p>
                </div>
            </div>
        </section>

    </main>

    <nav class="fixed bottom-0 left-0 right-0 glass border-t border-white/5 px-6 py-3 flex justify-around items-center rounded-t-[2.5rem]">
        <button onclick="showTab('sales')" class="flex flex-col items-center gap-1 text-slate-500 active-tab" id="btn-sales">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
            <span class="text-[9px] font-bold uppercase">Vendas</span>
        </button>
        <button onclick="showTab('leads')" class="flex flex-col items-center gap-1 text-slate-500" id="btn-leads">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
            <span class="text-[9px] font-bold uppercase">Leads</span>
        </button>
        <button onclick="showTab('traffic')" class="flex flex-col items-center gap-1 text-slate-500" id="btn-traffic">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
            <span class="text-[9px] font-bold uppercase">Tráfego</span>
        </button>
    </nav>

    <script>
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(el => el.classList.remove('active-tab'));
            document.getElementById(tabId).classList.add('active');
            document.getElementById('btn-' + tabId).classList.add('active-tab');
        }

        async function initData() {
            // Aqui o código busca os dados das variáveis que você configurou
            try {
                const [salesRes, leadsRes, trafficRes] = await Promise.all([
                    fetch('/api/vendas'),
                    fetch('/api/leads').catch(() => ({json: () => []})),
                    fetch('/api/traffic').catch(() => ({json: () => []}))
                ]);

                const salesData = await salesRes.json();
                let totalS = 0;
                const list = document.getElementById('sales-list');
                list.innerHTML = '';
                
                salesData.reverse().forEach(item => {
                    const v = parseFloat(String(item["VALOR "] || item["VALOR"]).replace(',', '.'));
                    totalS += v;
                    list.innerHTML += `<div class="glass p-4 rounded-3xl flex justify-between items-center text-sm font-bold"><span>${item.nome}</span><span class="text-blue-400">R$ ${v.toFixed(2)}</span></div>`;
                });

                document.getElementById('sales-total').innerText = totalS.toLocaleString('pt-BR', {style:'currency', currency:'BRL'});
                document.getElementById('vendas').innerText = salesData.length;
                
                // Exemplo de preenchimento de Leads e Tráfego
                document.getElementById('leads-count').innerText = "142"; // Exemplo vindo do seu IASTUDIO
                document.getElementById('traffic-spend').innerText = "R$ 1.250,00";
            } catch(e) { console.log(e) }
        }
        initData();
    </script>
</body>
</html>
